{% extends "base.html" %}

{% block title %}Likeable - Create Apps by Chatting with AI{% endblock %}

{% block content %}
<div class="text-center py-20">
    <!-- Hero Section -->
    <div class="mb-8 min-h-[400px]">
        <h1 class="text-6xl font-bold mb-6 text-gray-900">Build something Likeable</h1>
        <p class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">Create apps and websites by chatting with AI, similar to Lovable</p>

        <div class="flex justify-center mb-8">
            <div class="bg-white rounded-lg p-6 max-w-xl w-full shadow-lg border border-gray-200">
                <div class="flex items-center space-x-3 mb-4">
                    <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                    <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                    <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                    <div class="text-sm text-gray-500 ml-2">Create New App</div>
                </div>
                
                <!-- Fake Text Input -->
                <div class="relative mb-4">
                    <input 
                        type="text" 
                        placeholder="Describe what you want to build..." 
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-400 cursor-not-allowed"
                        disabled
                        readonly
                    >
                    <div class="absolute right-3 top-1/2 transform -translate-y-1/2">
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                    </div>
                </div>
                
                <!-- Create Button -->
                <button id="createAppBtn" onclick="createApp()" class="w-full bg-pink-600 hover:bg-pink-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition duration-200 transform hover:scale-105">
                    Create App
                </button>
                
                <!-- Loading Spinner -->
                <div id="spinner" class="hidden">
                    <div class="flex items-center justify-center space-x-3">
                        <div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-pink-600"></div>
                        <p class="text-gray-600">Creating your app...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-10 rounded-xl p-4 bg-white shadow-lg">
        <h2 class="text-2xl font-bold mb-4 text-gray-900">Community</h2>
        <p class="text-gray-600 mb-4">
            You can see what other people are building and build on top of their work.
        </p>
        <div class="grid grid-cols-3 gap-4"> 
            {% for app_id in apps %}
                <a href="/app/{{ app_id }}">
                    <div class="border-2 border-gray-200 rounded-lg p-4 bg-gray-50">
                        <iframe
                            id="previewFrame"
                            src="/api/app/{{ app_id }}/display"
                            class="w-full h-full border-t border-gray-200"
                            title="App Preview"
                        ></iframe>
                    </div>
                </a>
            {% endfor %}
            {% if apps|length == 0 %}
                <div class="border-2 border-gray-200 rounded-lg p-4 bg-gray-50 flex flex-col items-center justify-center">
                    <h3 class="text-lg font-bold mb-2 text-gray-900">No apps yet</h3>
                    <p class="text-gray-600">Why don't you create one?</p>
                </div>
                {% for i in range(5) %}
                    <div class="border-2 border-gray-200 rounded-lg p-4 bg-gray-50 flex flex-col items-center justify-center">
                        <h3 class="text-lg font-bold mb-2 text-gray-900">...</h3>
                        <p class="text-gray-600">..</p>
                    </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
async function createApp() {
    const button = document.getElementById('createAppBtn');
    const spinner = document.getElementById('spinner');
    
    // Show spinner and hide button
    button.style.display = 'none';
    spinner.classList.remove('hidden');
    
    try {
        const response = await fetch('/api/create', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        });
        const data = await response.json();
        if (data.app_id) {
            window.location.href = `/app/${data.app_id}`;
        }
    } catch (error) {
        console.error('Error creating app:', error);
        // Show button again and hide spinner on error
        button.style.display = 'inline-block';
        spinner.classList.add('hidden');
    }
}
</script>
{% endblock %} 